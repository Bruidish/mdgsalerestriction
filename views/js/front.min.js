'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var MdgSaleRestriction=function(){function a(){return _classCallCheck(this,a),this.$wrapper=$('#mdgsalerestriction-wrap'),!!this.$wrapper.length&&void(this.idProduct=parseInt(this.$wrapper.data('id_product')),this.soldQuantity=parseInt(this.$wrapper.data('sold_quantity')),this.wantedQuantity=parseInt(this.$wrapper.data('wanted_quantity')),this.limitQuantity=parseInt(this.$wrapper.data('limit_quantity')),$('#quantity_wanted').attr('max',this.limitQuantity-(this.wantedQuantity+this.soldQuantity)),this.events())}return _createClass(a,[{key:'events',value:function b(){var a=this;prestashop.on('updateCart',function(b){a.wantedQuantity=0;for(var c=0;c<b.resp.cart.products.length;c++)b.resp.cart.products[c].id_product==a.idProduct&&(a.wantedQuantity+=parseInt(b.resp.cart.products[c].quantity_wanted));a.render()}),$('body').on('change keyup','#quantity_wanted',function(b){var c=$(b.currentTarget);c.val()>a.limitQuantity-(a.wantedQuantity+a.soldQuantity)&&c.val(a.limitQuantity-(a.wantedQuantity+a.soldQuantity))})}},{key:'render',value:function a(){$('#quantity_wanted').attr('max',this.limitQuantity-(this.wantedQuantity+this.soldQuantity)),$('.product-add-to-cart .add button').attr('disabled',this.wantedQuantity+this.soldQuantity>=this.limitQuantity),$('.product-add-to-cart .availableForOrder').toggleClass('d-none',this.wantedQuantity+this.soldQuantity>=this.limitQuantity),$('.product-add-to-cart .notAvailableForOrder').toggleClass('d-none',this.wantedQuantity+this.soldQuantity<this.limitQuantity)}}]),a}();$(function(){new MdgSaleRestriction});
