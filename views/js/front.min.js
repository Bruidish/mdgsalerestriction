'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var MdgSaleRestrictionProduct=function(){function a(b){return _classCallCheck(this,a),this.wrapper=b,this.$wrapper=$(this.wrapper),!!this.$wrapper.length&&void(this.idProduct=parseInt(this.$wrapper.data('id_product')),this.soldQuantity=parseInt(this.$wrapper.data('sold_quantity')),this.wantedQuantity=parseInt(this.$wrapper.data('wanted_quantity')),this.limitQuantity=parseInt(this.$wrapper.data('limit_quantity')),this.render(),this.events())}return _createClass(a,[{key:'events',value:function b(){var a=this;prestashop.on('updateCart',function(b){a.wantedQuantity=0;for(var c=0;c<b.resp.cart.products.length;c++)b.resp.cart.products[c].id_product==a.idProduct&&(a.wantedQuantity+=parseInt(b.resp.cart.products[c].quantity_wanted));a.render()}),$(document).on('change keyup','#quantity_wanted',function(b){var c=$(b.currentTarget);if(c.val()>a.limitQuantity-(a.wantedQuantity+a.soldQuantity))return c.val(a.limitQuantity-(a.wantedQuantity+a.soldQuantity)),!1})}},{key:'render',value:function b(){var a=this.wantedQuantity+this.soldQuantity>=this.limitQuantity;$('#quantity_wanted').attr('disabled',a),$('.product-add-to-cart .add button').attr('disabled',a),$('.product-add-to-cart .availableForOrder').toggleClass('d-none',a),$('.product-add-to-cart .notAvailableForOrder').toggleClass('d-none',!a)}}]),a}(),MdgSaleRestrictionCart=function(){function a(b){return _classCallCheck(this,a),this.wrapper=b,this.$wrapper=$(this.wrapper),!!(this.$wrapper.length&&'undefined'!=typeof mdgsalerestriction)&&void(this.render(),this.events())}return _createClass(a,[{key:'render',value:function a(){$.each($('input.js-cart-line-product-quantity',this.$wrapper),function(a,b){var c=$(b),d=c.closest('li');if(mdgsalerestriction[c.data('product-id')]){var e=mdgsalerestriction[c.data('product-id')].limitQuantity-mdgsalerestriction[c.data('product-id')].soldQuantity;d.find('.mdgsalerestriction-message').remove(),d.find('.product-line-grid-body').append('\n            <div class="product-line-info mdgsalerestriction-message">\n              '+mdgsalerestriction[c.data('product-id')].text_available+'\n            </div>\n          '),c.on('touchspin.on.startupspin keyup',function(){if(c.val()>e)return c.val(e),!1})}})}},{key:'events',value:function b(){var a=this;prestashop.on('updatedCart',function(){a.$wrapper=$(a.wrapper),a.render()})}}]),a}();$(function(){new MdgSaleRestrictionProduct('#mdgsalerestriction-wrap'),new MdgSaleRestrictionCart('.cart-overview')});
